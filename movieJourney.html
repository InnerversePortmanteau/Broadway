<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Our Movie Quest: A Collaborative Framework</title>
<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<style>
  body { font-family: 'Inter', sans-serif; background: black; color: #e2e8f0; min-height: 100vh; margin: 0; overflow-x: hidden; }
  canvas#starfield { position: fixed; top:0; left:0; z-index:-1; }
  .glass-card { background: rgba(30, 41, 59, 0.8); backdrop-filter: blur(10px); border: 1px solid rgba(148,163,184,0.1); }
  .quadrant { transition: all 0.6s ease; cursor: pointer; border-radius:1.5rem; margin-bottom:1rem; }
  .quadrant.expanded { position: relative; transform: scale(1.05); border-top: 8px solid transparent; border-bottom: 8px solid transparent; animation: reelAppear 0.8s forwards; z-index:10; }
  @keyframes reelAppear { 0% { border-image: none; border-top-color: transparent; border-bottom-color: transparent; } 50%,100% { border-image: repeating-linear-gradient(to right,#94a3b8 0 10px,transparent 10px 20px) 20 round; border-top-color:#94a3b8; border-bottom-color:#94a3b8; border-image-slice:100; } }
  .quadrant.expanded::after { content:""; position:absolute; top:0; left:-100%; width:200%; height:100%; background:linear-gradient(120deg,transparent 0%,rgba(255,255,255,0.1) 50%,transparent 100%); animation: reelShimmer 2s infinite; pointer-events:none; border-radius:inherit; }
  @keyframes reelShimmer { from { left:-100%; } to { left:100%; } }
  .expand-btn { transition: all 0.3s ease; width:32px; height:32px; display:flex; align-items:center; justify-content:center; border-radius:50%; background: rgb(51,65,85); border:none; color:white; font-weight:bold; font-size:1.125rem; cursor:pointer; }
  .expand-btn:hover { background: rgb(71,85,105); transform:scale(1.1); }
  .expand-btn.rotated { transform: rotate(45deg) scale(1.1); }
  .crisis-btn { background: #b91c1c; color: white; padding:0.5rem 1rem; border-radius:0.5rem; transition: background 0.3s; }
  .crisis-btn:hover { background: #dc2626; }
  .fade-in { animation: fadeIn 0.5s ease-in; }
  @keyframes fadeIn { from { opacity: 0; } to { opacity:1; } }
  .movie-card img { width:100%; height:auto; border-radius:0.75rem; margin-top:0.5rem; }
  .btn-primary { width:100%; padding:0.5rem 1rem; margin-top:0.5rem; font-weight:600; color:white; background:linear-gradient(135deg, rgb(59,130,246) 0%, rgb(99,102,241) 100%); border:none; border-radius:0.5rem; box-shadow:0 4px 14px 0 rgba(59,130,246,0.3); transition: all 0.3s ease; cursor:pointer; }
  .btn-primary:hover:not(:disabled) { background:linear-gradient(135deg, rgb(37,99,235) 0%, rgb(79,70,229) 100%); transform:translateY(-1px); box-shadow:0 10px 25px rgba(59,130,246,0.4); }
  .btn-primary:disabled { cursor:not-allowed; }
  .rewards-badge { display:inline-block; padding:0.25rem 0.75rem; border-radius:9999px; font-size:0.875rem; font-weight:bold; }
  .rewards-earned { background: rgba(34,197,94,0.2); color: rgb(34,197,94); border:1px solid rgba(34,197,94,0.3); animation: pulseGlow 2s infinite; }
  @keyframes pulseGlow { 0%,100%{box-shadow:0 0 5px rgba(34,197,94,0.5);}50%{box-shadow:0 0 20px rgba(34,197,94,0.8);} }
  .collapse-btn { padding:0.25rem 0.75rem; background:#374151; color:white; border-radius:0.5rem; margin-top:0.5rem; cursor:pointer; }
  .collapse-btn:hover { background:#4b5563; }
</style>
</head>
<body class="p-4 sm:p-8">
<canvas id="starfield"></canvas>

<div class="container mx-auto">
  <!-- Header -->
  <header class="text-center py-8">
    <h1 class="text-4xl sm:text-5xl font-extrabold tracking-tight text-transparent bg-clip-text bg-gradient-to-r from-indigo-400 to-purple-400 mb-4">Our Movie Quest</h1>
    <p class="mt-4 text-xl text-slate-400">A collaborative framework for our shared journey to cinema victory.</p>
  </header>

  <!-- Audio Player -->
  <div class="glass-card rounded-2xl p-6 mb-8 text-center">
    <h3 class="text-2xl font-bold text-white mb-4 flex items-center justify-center gap-2"><span class="text-2xl">üéµ</span> Our Movie Quest Theme Song</h3>
    <audio id="movie-theme-song" controls class="w-full rounded-lg"></audio>
  </div>

  <!-- Main Grid -->
  <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">

    <!-- Quadrant 1: Known Knowns -->
    <div id="quadrant-1" class="quadrant known-knowns glass-card p-6 shadow-xl border border-slate-700" onclick="window.toggleDetails(this, event)">
      <div class="quadrant-header flex justify-between items-center">
        <div class="quadrant-title-group flex items-center space-x-3">
          <span class="quadrant-icon text-2xl">üé¨</span>
          <div>
            <h2 class="text-2xl font-bold text-white">Known Knowns</h2>
            <p class="text-sm text-slate-400">The AMC Stubs Goal</p>
          </div>
        </div>
        <button class="expand-btn">+</button>
      </div>
      <div class="quadrant-details mt-4 hidden">
        <p class="mb-4 text-slate-300">This is our foundation. We know the rules and the rewards. Our goal is clear: to watch the movies and unlock the perks.</p>
        <div class="glass-card p-4 rounded-xl mb-6">
          <div class="flex items-center justify-between mb-2">
            <span class="font-semibold text-sm">Movies Watched: <span id="movies-watched" class="font-bold text-white">0</span>/5</span>
            <span id="rewards-status" class="text-sm font-bold"></span>
          </div>
          <div class="progress-bar mt-2 bg-slate-700 rounded-full overflow-hidden">
            <div id="progress-fill" class="progress-fill h-4 bg-gradient-to-r from-teal-400 to-green-500 transition-all"></div>
          </div>
        </div>
        <div class="mt-6 space-y-4">
          <div class="movie-card" data-movie="Downton Abbey: The Grand Finale">
            <h3 class="text-white font-bold">Downton Abbey: The Grand Finale</h3>
            <img src="Downton_Abbey_The_Grand_Finale.jpg" alt="Crawley family final scene">
            <button class="btn-primary" onclick="window.trackMovie(this,event)">Mark as Watched</button>
          </div>
          <div class="movie-card" data-movie="Anemone">
            <h3 class="text-white font-bold">Anemone</h3>
            <img src="Anemone.jpg" alt="Underwater woman with octopus">
            <button class="btn-primary" onclick="window.trackMovie(this,event)">Mark as Watched</button>
          </div>
          <div class="movie-card" data-movie="Bugonia">
            <h3 class="text-white font-bold">Bugonia</h3>
            <img src="Bugonia.jpg" alt="TV producer shocked with glowing insect">
            <button class="btn-primary" onclick="window.trackMovie(this,event)">Mark as Watched</button>
          </div>
          <div class="movie-card" data-movie="Hamnet">
            <h3 class="text-white font-bold">Hamnet</h3>
            <img src="Hamnet.jpg" alt="Young boy in 16th century England">
            <button class="btn-primary" onclick="window.trackMovie(this,event)">Mark as Watched</button>
          </div>
          <div class="movie-card" data-movie="Song Sung Blue">
            <h3 class="text-white font-bold">Song Sung Blue</h3>
            <img src="Song_Sung_Blue.jpg" alt="Elderly musicians on stage">
            <button class="btn-primary" onclick="window.trackMovie(this,event)">Mark as Watched</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Quadrant 2: Known Unknowns -->
    <div id="quadrant-2" class="quadrant known-unknowns glass-card p-6 shadow-xl border border-slate-700" onclick="window.toggleDetails(this, event)">
      <div class="quadrant-header flex justify-between items-center">
        <div class="quadrant-title-group flex items-center space-x-3">
          <span class="quadrant-icon text-2xl">üìù</span>
          <div>
            <h2 class="text-2xl font-bold text-white">Known Unknowns</h2>
            <p class="text-sm text-slate-400">The Planning & Research</p>
          </div>
        </div>
        <button class="expand-btn">+</button>
      </div>
      <div class="quadrant-details mt-4 hidden">
        <p class="mb-4 text-slate-300">These are the gaps in our knowledge that we can fill with a little planning. Let's ask some questions to convert these unknowns into our foundation.</p>
        <div class="glass-card p-4 rounded-xl space-y-4">
          <div class="glass-card p-4 rounded-xl border border-slate-700">
            <p class="text-sm text-slate-300 font-semibold mb-2">Phase 1: Information Overload</p>
            <ul class="text-slate-400 text-sm list-disc list-inside space-y-1">
              <li>Which movie are we most excited to see first?</li>
              <li>What if we weren't spending so much time on showtimes and could just focus on popcorn?</li>
              <li>What's the real cost of our time spent on this decision?</li>
            </ul>
          </div>
          <div class="glass-card p-4 rounded-xl border border-slate-700">
            <p class="text-sm text-slate-300 font-semibold mb-2">Phase 2: Creative Productivity</p>
            <ul class="text-slate-400 text-sm list-disc list-inside space-y-1">
              <li>Are we confident that we're in full control of our movie nights, and not just dependent on a third party's business model?</li>
              <li>How would it feel to have a data-backed case for our movie night, so we can stop guessing?</li>
            </ul>
          </div>
        </div>
      </div>
    </div>

    <!-- Quadrant 3: Unknown Knowns -->
    <div id="quadrant-3" class="quadrant unknown-knowns glass-card p-6 shadow-xl border border-slate-700" onclick="window.toggleDetails(this, event)">
      <div class="quadrant-header flex justify-between items-center">
        <div class="quadrant-title-group flex items-center space-x-3">
          <span class="quadrant-icon text-2xl">ü§ù</span>
          <div>
            <h2 class="text-2xl font-bold text-white">Unknown Knowns</h2>
            <p class="text-sm text-slate-400">Our Shared Relational World</p>
          </div>
        </div>
        <button class="expand-btn">+</button>
      </div>
      <div class="quadrant-details mt-4 hidden">
        <p class="mb-4 text-slate-300">Drawing from the wisdom of "The Untouchables," this is about finding power and safety not in individual strength, but in our shared loyalty and trust. Our combined tastes, hunches, and preferences are our hidden wisdom.</p>
        <div class="glass-card p-4 rounded-xl">
          <h4 class="font-semibold text-slate-300 mb-2">Our "Relational Holding Environment"</h4>
          <p class="text-sm text-slate-400">Just like Eliot Ness found strength in his team, our movie quest is a shared endeavor. It's in the discussions on the car ride home, the shared laughter in the theater, and the agreement on the next movie that we discover our true collaborative power.</p>
        </div>
      </div>
    </div>

    <!-- Quadrant 4: Unknown Unknowns -->
    <div id="quadrant-4" class="quadrant unknown-unknowns glass-card p-6 shadow-xl border border-slate-700" onclick="window.toggleDetails(this, event)">
      <div class="quadrant-header flex justify-between items-center">
        <div class="quadrant-title-group flex items-center space-x-3">
          <span class="quadrant-icon text-2xl">üé≤</span>
          <div>
            <h2 class="text-2xl font-bold text-white">Unknown Unknowns</h2>
            <p class="text-sm text-slate-400">Navigating the Unpredictable</p>
          </div>
        </div>
        <button class="expand-btn">+</button>
      </div>
      <div class="quadrant-details mt-4 hidden">
        <p class="mb-4 text-slate-300">These are the unpredictable "black swan" events that could derail our plans. Maybe the movie is sold out, or traffic is a mess. Our resilience is key here.</p>
        <div class="glass-card p-4 rounded-xl text-center">
          <h4 class="font-semibold text-slate-300 mb-4">Social Entropy Simulator</h4>
          <p class="text-sm text-slate-400 mb-4">Click to see how our combined resilience handles an unexpected challenge.</p>
          <button id="crisis-button" class="crisis-btn">Trigger a Scheduling Crisis!</button>
          <div id="crisis-result" class="mt-4 p-3 rounded-lg text-sm bg-red-900/30 border border-red-800 hidden fade-in"></div>
        </div>
      </div>
    </div>

  </div>
</div>

<script>
const audioUrl = 'https://cdn.jsdelivr.net/gh/InnerversePortmanteau/Broadway/our-movie-quest.mp3';
let movieData = JSON.parse(localStorage.getItem('movieData')) || {};
const totalMovies = 5;
const progressFill = document.getElementById('progress-fill');
const moviesWatchedSpan = document.getElementById('movies-watched');
const rewardsStatus = document.getElementById('rewards-status');
const crisisButton = document.getElementById('crisis-button');
const crisisResult = document.getElementById('crisis-result');
const movieCards = document.querySelectorAll('.movie-card');

function updateProgress() {
  const count = Object.keys(movieData).length;
  moviesWatchedSpan.textContent = count;
  progressFill.style.width = (count / totalMovies * 100) + '%';
  movieCards.forEach(card => {
    const movie = card.dataset.movie;
    const button = card.querySelector('button');
    if(movieData[movie]) { card.classList.add('watched'); button.disabled=true; button.textContent="‚úì Watched"; } 
    else { card.classList.remove('watched'); button.disabled=false; button.textContent="Mark as Watched"; }
  });
  if(count>=3){ rewardsStatus.innerHTML='<span class="rewards-badge rewards-earned">üéâ $50 Gift Card Earned! üéâ</span>'; }
  else if(count>=2){ rewardsStatus.innerHTML='<span class="rewards-badge rewards-earned">üëè $15 Gift Card Earned! üëè</span>'; }
  else { rewardsStatus.innerHTML=''; }
}

window.trackMovie = function(button,event){
  event.stopPropagation();
  const card = button.closest('.movie-card');
  const movie = card.dataset.movie;
  if(!movieData[movie]){
    movieData[movie]=true;
    localStorage.setItem('movieData',JSON.stringify(movieData));
    button.style.transform='scale(0.95)';
    setTimeout(()=>{ button.style.transform=''; updateProgress(); },150);
  }
}

window.toggleDetails = function(quadrant, event){
  // Prevent clicks on buttons or links inside the quadrant from triggering a toggle
  if (event.target.tagName.toLowerCase() === 'button' || event.target.tagName.toLowerCase() === 'a') {
    return;
  }
  const details = quadrant.querySelector('.quadrant-details');
  const btn = quadrant.querySelector('.expand-btn');
  const isExpanded = details.classList.toggle('hidden');
  quadrant.classList.toggle('expanded',!isExpanded);
  btn.textContent = isExpanded ? '+' : '‚àí';
  btn.classList.toggle('rotated',!isExpanded);
}

crisisButton.addEventListener('click',(e)=>{
  e.stopPropagation();
  const crises = ["StubHub nightmare: 5 orders, 0 tickets. 6 hours lost.","Traffic jams from parallel universe.","Movie suddenly sold out.","Popcorn machine explodes"];
  const crisis=crises[Math.floor(Math.random()*crises.length)];
  crisisResult.innerHTML=`<div class="font-semibold text-red-300 mb-2">CRISIS:</div><div class="text-red-200">${crisis}</div>`;
  crisisResult.classList.remove('hidden');
  setTimeout(()=>{
    crisisResult.innerHTML+=`<div class="mt-4 pt-3 border-t border-green-800/30"><div class="font-semibold text-green-300 mb-2">Relational Solution:</div><div class="text-green-200 text-left">Collaborate and adapt: reschedule, compromise, or grab dinner. Fun is the goal!</div></div>`;
  },1500);
});

// New, more reliable event listeners for mobile scrolling
const quadrants = document.querySelectorAll('.quadrant');
let touchStartX = 0;
let touchStartY = 0;
let wasMoved = false;

quadrants.forEach(quadrant => {
    quadrant.addEventListener('touchstart', (e) => {
        touchStartX = e.touches[0].clientX;
        touchStartY = e.touches[0].clientY;
        wasMoved = false; // Reset the flag
    });

    quadrant.addEventListener('touchmove', (e) => {
        const deltaX = e.touches[0].clientX - touchStartX;
        const deltaY = e.touches[0].clientY - touchStartY;
        // If the finger moves more than a small threshold, it's a scroll, not a tap
        if (Math.abs(deltaX) > 5 || Math.abs(deltaY) > 5) {
            wasMoved = true;
        }
    });

    quadrant.addEventListener('touchend', (e) => {
        // If the finger moved significantly, it was a scroll, so don't toggle
        if (wasMoved) {
            return;
        }
        // Otherwise, it was a tap, so we call the toggle function
        window.toggleDetails(quadrant, e);
    });
});


// Starfield
const canvas = document.getElementById('starfield');
const ctx = canvas.getContext('2d');
let stars=[];
function resize(){ canvas.width=window.innerWidth; canvas.height=window.innerHeight; stars=[]; for(let i=0;i<200;i++){ stars.push({x:Math.random()*canvas.width, y:Math.random()*canvas.height, r:Math.random()*1.2+0.2, dx:(Math.random()-0.5)*0.1, dy:(Math.random()-0.5)*0.1}); } }
function animate(){ ctx.clearRect(0,0,canvas.width,canvas.height); for(let s of stars){ ctx.beginPath(); ctx.arc(s.x,s.y,s.r,0,2*Math.PI); ctx.fillStyle="white"; ctx.globalAlpha=Math.random()*0.5+0.5; ctx.fill(); s.x+=s.dx; s.y+=s.dy; if(s.x<0)s.x=canvas.width;if(s.x>canvas.width)s.x=0;if(s.y<0)s.y=canvas.height;if(s.y>canvas.height)s.y=0; } requestAnimationFrame(animate); }
window.addEventListener('resize',resize); resize(); animate();

window.onload=function(){
  document.getElementById('movie-theme-song').src=audioUrl;
  updateProgress();
  window.toggleDetails(document.getElementById('quadrant-1'), {target: document.getElementById('quadrant-1'), stopPropagation:()=>{}});
}
</script>
</body>
</html>